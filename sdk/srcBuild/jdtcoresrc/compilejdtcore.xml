<?xml version="1.0" encoding="UTF-8"?>

<!-- build script to create a batch compiler from org.eclipse.jdt.core -->
<project name="Compile jdtcore" default="compile">
	<target name="init">
		<tstamp/>
		<property name="destdir" value="compiler2" />
                <property name="srcdir" value="src" />

	</target>

	<target name="compile" depends="init">

		<echo message="TARGET: ${destdir}" />
		<delete dir="${destdir}"/>
		<mkdir dir="${destdir}"/>

               <condition property="build.compiler" value="org.eclipse.jdt.core.JDTCompilerAdapter">
                        <and>
                                <available file="jdtcore.jar" />
                        </and>
                </condition> 
                <condition property="compilerArg" value="-encoding ISO-8859-1">
                        <equals arg1="${build.compiler}" arg2="org.eclipse.jdt.core.JDTCompilerAdapter" />
                </condition>  


                <echo message="compilerArg ${compilerArg}"/>
                <echo message="build compiler ${build.compiler}"/>

                <property name="compilerArg" value="-encoding ISO-8859-1" />
                <property name="javacSource" value="1.3" />
                <property name="javacTarget" value="1.2" />
                <property name="javacDebugInfo" value="true" />
                <property name="javacFailOnError" value="true" />
                <record name="../compilelog.txt" action="start" />
                <javac verbose="true" srcdir="${srcdir}" destdir="${destdir}"/>
                <record name="../compilelog.txt" action="stop" />
                                                                                                                          

                <javac verbose="true" srcdir="${srcdir}" destdir="${destdir}"/>  

                <echo message="UPDATE jdtcore.jar" />
                <copy todir="${destdir}">
                        <fileset dir="${srcdir}">
                             <include name="**/*.properties"/>
                             <include name="**/*.rsc"/>
                        </fileset>
                        </copy>

                <jar jarfile="../jdtcore.jar" basedir="${destdir}">
                        <fileset dir="${destdir}"/>
                </jar>
 
                <!-- delete first jdtcore compiler -->
                 <delete file="jdtcore.jar"/> 
                 

	</target>
</project>
