<project default="noDefault">

	<target name="noDefault" />

	<!-- set the root of the output file name -->
	<property name="archiveRoot" value="master-equinox-${buildId}" />

	<!-- Target to get the packaging map files for the components of interest
     The files must be fetched into the downloadDirectory folder -->
	<target name="getMapFiles" unless="mapsFetched">
		<copy file="${packagingInfo}/../../../../packaging.map" tofile="${downloadDirectory}/packaging.map" />
	</target>


	<target name="assemble.common.common.common.xml">
		<antcall target="assembler">
			<param name="archiveName" value="${archiveRoot}.zip" />
		</antcall>
	</target>


	<target name="assembler">
		<mkdir dir="${equinoxPostingDirectory}/${buildLabel}/checksum" />
		<property name="archiveFullPath" value="${buildDirectory}/${buildLabel}/${archiveName}" />
		<ant antfile="${assembleScriptName}" />
		<!--unzip plug-ins to equinoxPostingDirectory-->
		<exec executable="unzip" dir="${buildDirectory}/${buildLabel}">
			<arg line="-j ${archiveName} eclipse/plugins/*.jar -x eclipse/plugins/*jmx* -d ${equinoxPostingDirectory}/${buildLabel}" />
		</exec>
		<!--HACK extract supplement bundle from eclipse master because it is missing in master-equinox zip-->
		<exec executable="unzip" dir="${buildDirectory}/${buildLabel}">
			<arg line="-j ${archiveName} eclipse/plugins/org.eclipse.equinox.supplement_*.jar -d ${equinoxPostingDirectory}/${buildLabel}" />
		</exec>
		<!--HACK extract launcher from eclipse master because it is missing in master-equinox zip-->
        <exec executable="unzip" dir="${basedir}">
			<arg line="-j ${postingDirectory}/${buildLabel}/eclipse-SDK-${buildId}-b4p2-win32.zip eclipse/plugins/org.eclipse.equinox.launcher_* -d ${equinoxPostingDirectory}/${buildLabel}"/>
		</exec>
	</target>

</project>
