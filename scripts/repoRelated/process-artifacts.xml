<project
    default="processArtifacts"
    basedir=".">
    <target name="processArtifacts">

    	 <!-- normally, caller would set repoDirLocation, but for local operation, can hard code here -->
        <property
            name="repoDirLocation"
            value="/shared/webtools/committers/wtp-R3.3.0-I/20101209114749/S-3.3.0M4-20101209114749/repository" />
        <p2.process.artifacts
            pack="true"
            repositoryPath="file:/${repoDirLocation}" />

        
        
        <!-- 
            we remove these, because they end up having invalid pack.gz 
            files.  
            -->
        <p2.remove.iu>
            <repository location="file://${repoDirLocation}" />
            <iu
                id="com.ibm.icu"
                artifacts="(format=packed)" />
            <iu
                id="com.ibm.icu.base"
                artifacts="(format=packed)" />
            <iu
                id="com.ibm.icu.source"
                artifacts="(format=packed)" />
            <iu
                id="com.ibm.icu.base.source"
                artifacts="(format=packed)" />
            <iu
                id="org.eclipse.jdt.core.tests.compiler"
                artifacts="(format=packed)" />

        </p2.remove.iu>
        
        
        <!-- This is to remove IUs handy during the build, but not really 
            needed in final repo -->
        <!--
           we used to remove this IU, but leavig it now. 
           See bug 378137
           https://bugs.eclipse.org/bugs/show_bug.cgi?id=378137
           <iu id="org.aspectj.runtime" /> 
        -->
        <!-- 
           Note, we used to not remove 
           master-equinox.feature.group
           but that technically makes the repo invalid since 
           it requires other things we removed. See bug 377314
           https://bugs.eclipse.org/bugs/show_bug.cgi?id=377314
        -->
        <p2.remove.iu>
            <repository location="file://${repoDirLocation}" />
            <iu id="org.aspectj.weaver" />
            <iu id="master.feature.group" />
            <iu id="master-ecf.feature.group" />
            <iu id="master-jetty.feature.group" />
            <iu id="master-equinox-weaving.feature.group" />
            <id id="master-equinox.feature.group" />

        </p2.remove.iu>

        
        <!-- clean up some unnecessary files, in case they are around -->
        <delete
            failonerror="false"
            quiet="true">
            <fileset
                dir="${repoDirLocation}"
                includes="artifacts.jar.pack.gz, content.jar.pack.gz, site.xml" />
        </delete>

    </target>
</project>

