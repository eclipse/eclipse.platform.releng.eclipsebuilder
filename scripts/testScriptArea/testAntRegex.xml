<project
    name="testregex"
    default="testregex"
    basedir=".">
    <property
        name="eclipseStream"
        value="4.2.0" />
    <target
        name="testregex"
        depends="init">

        <echo message="eclipseStream: ${eclipseStream}" />
        <echo message="eclipseStreamMajor: ${eclipseStreamMajor}" />
        <echo message="eclipseStreamMinor: ${eclipseStreamMinor}" />
        <echo message="eclipseStreamService: ${eclipseStreamService}" />

    </target>


    <!-- main purpose of init, it to be sure we have eclipseStreamMajor and eclipseStreamMinor -->
    <target name="init">
        <fail
            unless="eclipseStream"
            message="eclipseStream must be provided by caller" />
        <condition property="streamOK">
            <matches
                pattern="\d\.\d\.\d"
                string="${eclipseStream}" />
        </condition>
        <fail
            message="eclipseStream variable had unexpected format. Should be digit.digit.digit, but was ${eclipseStream}"
            unless="streamOK" />
        <propertyregex
            property="eclipseStreamMajor"
            input="eclipseStream"
            regexp="(\d)\.(\d)\.(\d)"
            select="\1" />
        <propertyregex
            property="eclipseStreamMinor"
            input="eclipseStream"
            regexp="(\d)\.(\d)\.(\d)"
            select="\2" />
        <propertyregex
            property="eclipseStreamService"
            input="eclipseStream"
            regexp="(\d)\.(\d)\.(\d)"
            select="\3" />
    </target>

</project>